Dealing with binary (Malware sample) which using statically imported OpenSource library.

Analyzing binary which statically imports OpenSrc lib is not usually as easy as in some example exercise...

Problems:
Symbols are usually stripped.
You have XXX functions which are not a part of user code but only library functions..
You must recognize important lib funcs to find out what the binary is doing..

Walk-Through:
You must find out what OpenSrc lib were used and also their versions (version info is not revealed via binary strings very often) - Tools: strings
You must find out the program which was used to compile the binary (for PE - analyzing of Rich header is the best way) - Tools: DIE, Nauz-File-Detector, Pe-Bear, Pestudio etc..)


In most cases you will find out the program which compiled the binary (Example: Visual Studio 2017)
You will usually find out the Opensrc lib which was used (but probably not the exact version)
Download some of the latest versions of the library and Compile the library (.lib, .a) with program you find out that was used to compile the binary.
You can also later compile .dll for use of bindiffing tools. (After you find out the specific version)

Generate your own FLIRT sigs with IDA flair tools --> Generate pattern file (.pat) for funcs in lib (flair tools - pcf, pelf etc...) --> Generate FLIRT signatures with tool sigmake to process the pattern file --> .sig file
Most of the time you will have to deal with collisions during FLIRT signatures creation (More functions in lib has same byte patter and you must decide which one will be used to match the pattern)

Try to apply newly generated FLIRT signatures for different versions of the OpenSource lib which was used in IDA on your binary.
Find out which FLIRT signatures (the version of lib) is matching the most functions in your binary.

Now after applying the FLIRT signatures which matched the most functions - there is high chance that you finally have the info about version of lib which was used in binary.
If possible compile .dll of the opensource lib - the one specific version.
Open the compiled .dll id IDA and use debug symbols (.pdb) for analysis.
Use bindiffing tools like Diaphora plugin in IDA - binary vs .dll - to catch more matching functions (Diaphora is using more fuzzy algos than basic pattern match)
After investigation of Diaphora results, apply newly revealed matched functions.

One can also use IDA plugin called Rizzo on the analyzed .dll and apply later the rizzo signatures in binary.
The last thing could be pulling metadata from LUMINA.

Now you have still much to analyze but it will be far better than before.
Suggested Tools: Strings, File, DIE, Nauz-File-Detector, Pe-Bear, Pestudio, IDA flair tools, Diaphora plugin for IDA, rizzo, Lumina...

Happy Reversing :)  
