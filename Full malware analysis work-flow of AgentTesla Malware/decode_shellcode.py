const_main = 0x0

with open(r"C:\Users\Inferno\Desktop\AgentTesla\shellcode.bin", "rb") as f:
    encoded_bytes =bytearray(f.read())

for i in range(0x162,len(encoded_bytes),4):
    const_main = ((const_main * 0x4DD9231F) + 0x101C24B5) & 0xffffffff
    temp = int.from_bytes(encoded_bytes[i:i+4],byteorder="little",signed=False) ^ const_main & 0xffffffff
    encoded_bytes[i:i+4] = int.to_bytes(temp,4,byteorder="little",signed=False)

with open(r"C:\Users\Inferno\Desktop\AgentTesla\decoded_shellcode.bin", "wb") as f:
    f.write(encoded_bytes)


