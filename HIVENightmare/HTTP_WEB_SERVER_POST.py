import http.server, os
from http.server import HTTPServer, BaseHTTPRequestHandler
import logging

class S(BaseHTTPRequestHandler):
    def _set_headers(self):
        self.send_response(200)
        self.send_header("Content-type", "text/html")
        self.send_header("Content-Length", str(len("Exfiltrated!"))) 
        self.end_headers()

    def do_POST(self):
        length = self.headers['content-length']
        data = self.rfile.read(int(length))
        with open("data.bin", 'wb') as fh:
            fh.write(data)

        self._set_headers()
        self.wfile.write(b"Exfiltrated!")

server_address = ('192.168.56.1', 80)
httpd = http.server.HTTPServer(server_address,S)

httpd.serve_forever()
