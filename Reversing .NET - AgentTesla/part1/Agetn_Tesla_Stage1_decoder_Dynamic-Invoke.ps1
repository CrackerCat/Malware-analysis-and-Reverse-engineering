#Patch original assembly in CFFExplorer or Cerbero Suite
#Patch methods flags ("private" - to - "public") to be dynamically invokable
#in this case patch methods "GameLoop0" and "A9283"

#loading patched assembly
$assembly = [System.Reflection.Assembly]::LoadFile("C:\Users\Inferno\Downloads\Analyze_AgentTesla\original_sample_patched.bin")
#loading obfuscated string field value
$mapx = (($assembly.GetType("VandelayHealthBenefits.VDObjects")).GetField("MapX")).GetValue($null)
#getting type and instance of class
$VandelaySplashScreen = $assembly.GetType("VandelayHealthBenefits.VandelaySplashScreen")

#invoke method "GameLoop0"
$deobfuscatedString_base64 = ($VandelaySplashScreen.GetMethod("GameLoop0")).invoke($null,$mapx)
#invoke method "A9283"
($VandelaySplashScreen.GetMethod("A9283")).invoke($null,$deobfuscatedString_base64)[0..250] | Format-Hex


