#Powershell script - decoding of strings in final payload via methods invoking

#reflective loading assembly
$AgentTesla_assembly = [System.Reflection.Assembly]::LoadFile("C:\Users\Inferno\Downloads\Analyze_AgentTesla\final_payload.bin")

#geting type of Class - to get access to methods - full namespace required
$class = $AgentTesla_assembly.GetType("<PrivateImplementationDetails>{C258EF39-24E9-47A1-8F4B-0E38158C4973}.741A036D-62F0-443C-B9BE-84FFF2F9A684")

#Invoke all mmethods with MetadataToken in range of desired methods
($class.GetMethods()| Where-Object {$_.MetadataToken -in (0x0600022E..0x06000542) -and $_.Module.ScopeName -eq "ybjsfZdvGJcJrVQvErebdIvpj.exe"}).invoke($null,$null)


