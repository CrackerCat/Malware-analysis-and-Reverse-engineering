#Powershell script - decoding of strings in final payload via geting Field of encoded bytes and initiating cctor

#reflective loading assembly
$AgentTesla_assembly = [System.Reflection.Assembly]::LoadFile("C:\Users\Inferno\Downloads\Analyze_AgentTesla\final_payload.bin")

 #geting type of Class - to get access to Fields - full namespace required
$class = $AgentTesla_assembly.GetType("<PrivateImplementationDetails>{C258EF39-24E9-47A1-8F4B-0E38158C4973}.741A036D-62F0-443C-B9BE-84FFF2F9A684")

#Getting field of encoded bytes (encoded strings) - its a part of cctor so we are actually initiating cctor and will get decoded bytes as the decoding routine is part of cctor
(($class.GetFields([System.Reflection.BindingFlags]::Static -bor [System.Reflection.BindingFlags]::NonPublic) | ? {$_.metadatatoken -eq 0x04000198}).GetValue($null) | %{[char]$_}) -join ""

